// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
Object.defineProperty(exports, "__esModule", { value: true });
exports.registerWithTeams = void 0;
const tslib_1 = require("tslib");
const childProcess = require("child_process");
const fs = require("fs");
/* global console */
function registerWithTeams(zipPath) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        return new Promise((resolve, reject) => {
            if (zipPath.endsWith(".zip") && fs.existsSync(zipPath)) {
                const command = `npx @microsoft/teamsfx-cli provision manifest --file-path ${zipPath}`;
                childProcess.exec(command, (error, stdout) => {
                    if (error) {
                        reject(stdout);
                    }
                    else {
                        console.log("Successfully registered package with https://dev.teams.microsoft.com/apps");
                        resolve();
                    }
                });
            }
            else {
                reject(new Error(`The file '${zipPath}' is not valid`));
            }
        });
    });
}
exports.registerWithTeams = registerWithTeams;
//# sourceMappingURL=publish.js.map